<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Expense Tracker</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to right, #74ebd5, #9face6);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 20px;
      transition: background 0.5s ease;
    }
    body.dark-mode {
      background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
      color: #f4f4f4;
    }
    .container {
      width: 100%;
      max-width: 450px;
      background: white;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
      transition: background 0.5s ease, color 0.5s ease;
    }
    body.dark-mode .container {
      background: #1e2a38;
      color: #f4f4f4;
    }
    h1, h2 {
      text-align: center;
      margin-bottom: 15px;
    }
    form {
      display: grid;
      gap: 10px;
      margin-bottom: 20px;
    }
    input, select, button {
      padding: 10px;
      border: none;
      border-radius: 10px;
      font-size: 14px;
      outline: none;
    }
    input, select {
      background: #f0f0f0;
    }
    body.dark-mode input, body.dark-mode select {
      background: #2d3d4f;
      color: #fff;
    }
    button {
      background: #0077ff;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s;
    }
    button:hover {
      transform: scale(1.05);
      background: #0056cc;
    }
    .expense-list {
      margin-top: 20px;
    }
    .expense-item {
      background: #f9f9f9;
      padding: 10px;
      border-radius: 12px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background 0.3s;
    }
    .expense-item:hover {
      background: #ececec;
    }
    body.dark-mode .expense-item {
      background: #2d3d4f;
    }
    .chart-container {
      margin-top: 20px;
    }
    .toggle-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    .budget-container {
      margin-top: 20px;
      padding: 15px;
      border-radius: 12px;
      background: #f0f0f0;
    }
    body.dark-mode .budget-container {
      background: #2d3d4f;
    }
    .progress-bar {
      width: 100%;
      height: 15px;
      background: #ddd;
      border-radius: 10px;
      overflow: hidden;
      margin-top: 10px;
    }
    .progress-fill {
      height: 100%;
      width: 0%;
      background: #28a745;
      transition: width 0.5s ease;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üí∞ Expense Tracker</h1>
    
    <div class="toggle-container">
      <label for="currency">Currency:</label>
      <select id="currency">
        <option value="‚Çπ">‚Çπ</option>
        <option value="$">$</option>
        <option value="‚Ç¨">‚Ç¨</option>
        <option value="¬£">¬£</option>
        <option value="¬•">¬•</option>
      </select>
      <button id="darkModeToggle">üåô</button>
    </div>

    <form id="expenseForm">
      <input type="text" id="title" placeholder="Expense Title" required />
      <input type="number" id="amount" placeholder="Amount" required />
      <select id="category">
        <option value="Food">Food</option>
        <option value="Travel">Travel</option>
        <option value="Bills">Bills</option>
        <option value="Shopping">Shopping</option>
        <option value="Other">Other</option>
      </select>
      <input type="date" id="date" required />
      <button type="submit">Add Expense</button>
    </form>

    <h2>Total: <span id="total">0</span></h2>

    <div class="budget-container">
      <h2>Monthly Budget</h2>
      <input type="number" id="budgetInput" placeholder="Set your budget" />
      <button id="setBudgetBtn">Set Budget</button>
      <p>Budget: <span id="budgetDisplay">Not set</span></p>
      <p>Remaining: <span id="remainingDisplay">-</span></p>
      <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    </div>

    <div class="expense-list" id="expenseList"></div>

    <div class="chart-container">
      <canvas id="expenseChart"></canvas>
    </div>
  </div>

  <script>
    let expenses = JSON.parse(localStorage.getItem("expenses")) || [];
    let currency = localStorage.getItem("currency") || "‚Çπ";
    let budget = parseFloat(localStorage.getItem("budget")) || 0;

    const form = document.getElementById("expenseForm");
    const list = document.getElementById("expenseList");
    const totalEl = document.getElementById("total");
    const currencySelect = document.getElementById("currency");
    const darkModeToggle = document.getElementById("darkModeToggle");
    const budgetInput = document.getElementById("budgetInput");
    const setBudgetBtn = document.getElementById("setBudgetBtn");
    const budgetDisplay = document.getElementById("budgetDisplay");
    const remainingDisplay = document.getElementById("remainingDisplay");
    const progressFill = document.getElementById("progressFill");

    let chart;

    function renderExpenses() {
      list.innerHTML = "";
      let total = 0;
      const categoryTotals = {};

      expenses.forEach((exp, index) => {
        total += exp.amount;
        categoryTotals[exp.category] = (categoryTotals[exp.category] || 0) + exp.amount;

        const item = document.createElement("div");
        item.className = "expense-item";
        item.innerHTML = `
          <span>${exp.title} - ${currency}${exp.amount} (${exp.category}) [${exp.date}]</span>
          <div>
            <button onclick="editExpense(${index})">‚úèÔ∏è</button>
            <button onclick="deleteExpense(${index})">‚ùå</button>
          </div>
        `;
        list.appendChild(item);
      });

      totalEl.textContent = currency + total;
      localStorage.setItem("expenses", JSON.stringify(expenses));

      updateBudget(total);

      if (chart) chart.destroy();
      const ctx = document.getElementById("expenseChart");
      chart = new Chart(ctx, {
        type: "doughnut",
        data: {
          labels: Object.keys(categoryTotals),
          datasets: [{
            data: Object.values(categoryTotals),
            backgroundColor: ["#0077ff", "#ff5733", "#ffc300", "#28a745", "#6f42c1"]
          }]
        }
      });
    }

    form.addEventListener("submit", e => {
      e.preventDefault();
      const title = document.getElementById("title").value;
      const amount = parseFloat(document.getElementById("amount").value);
      const category = document.getElementById("category").value;
      const date = document.getElementById("date").value;

      expenses.push({ title, amount, category, date });
      form.reset();
      renderExpenses();
    });

    function deleteExpense(index) {
      expenses.splice(index, 1);
      renderExpenses();
    }

    function editExpense(index) {
      const exp = expenses[index];
      document.getElementById("title").value = exp.title;
      document.getElementById("amount").value = exp.amount;
      document.getElementById("category").value = exp.category;
      document.getElementById("date").value = exp.date;
      expenses.splice(index, 1);
      renderExpenses();
    }

    currencySelect.value = currency;
    currencySelect.addEventListener("change", () => {
      currency = currencySelect.value;
      localStorage.setItem("currency", currency);
      renderExpenses();
    });

    if (localStorage.getItem("darkMode") === "enabled") {
      document.body.classList.add("dark-mode");
    }

    darkModeToggle.addEventListener("click", () => {
      document.body.classList.toggle("dark-mode");
      localStorage.setItem("darkMode", document.body.classList.contains("dark-mode") ? "enabled" : "disabled");
    });

    setBudgetBtn.addEventListener("click", () => {
      budget = parseFloat(budgetInput.value);
      localStorage.setItem("budget", budget);
      renderExpenses();
    });

    function updateBudget(total) {
      if (!budget || budget <= 0) {
        budgetDisplay.textContent = "Not set";
        remainingDisplay.textContent = "-";
        progressFill.style.width = "0%";
        return;
      }

      budgetDisplay.textContent = currency + budget;
      const remaining = budget - total;
      remainingDisplay.textContent = currency + remaining;

      let percent = Math.min((total / budget) * 100, 100);
      progressFill.style.width = percent + "%";
      progressFill.style.background = percent >= 100 ? "#dc3545" : percent >= 80 ? "#ffc107" : "#28a745";

      if (percent >= 100) {
        alert("‚ö†Ô∏è You have exceeded your budget!");
      } else if (percent >= 80) {
        alert("‚ö†Ô∏è You are close to reaching your budget!");
      }
    }

    renderExpenses();
  </script>
</body>
</html>
